# BACnet Read Write
## Profile for Wireshark Network Protocol Analyzer

**Revision 19.11 **- Initial Release

Prepared by: David Purser
Contributors:

November 2019

### 1 Description and Objective

This document summarizes the files and configuration of this Wireshark profile for use in analyzing BACnet Read/Polling and Writing Communications.

It is expected that installers know how to capture BACnet IP and/or MSTP communication and use this document to learn how to use this profile to assist in analysis.

### 2 Files Included

Folder / Profile Name: **BACnet General**

**cfilters** – capture filter. Edited by Capture -> Capture Filters….
**colorfilters** – packet colorization. Edited by View -> Coloring Rules…
**dfilter_buttons** – display filter buttons. Edited by + beside Expression… toolbar
**io_graphs** – IO graph filters. Edited by Statistics -> IO Graphs
**preferences** – Wireshark preferences. Edited by Edit -> Preferences

Install profile folder in **%AppData%\Wireshark\profiles**

### 3 Files Excluded

These files can be excluded as they are not pre-configured and are regenerated by Wireshark.

**decode_as_entries** – dissector assignments. Edited by Analyze -> Decode As…
**recent** – recent GUI related settings. Read at program start and written at program exit.

### 4 Preferences

Preferences changed from default GUI profile:
* Packet List & Packet Details in side-by-side view
* Packet Bytes window disabled

### 5 Coloring Rules

|Color|	Name|
|---|---|
|Light Green|	Read Property
|Green|	Read Property Multiple
|Light Purple|	Write Property
|Purple|	Write Property Multiple

### 6 Display Filter Buttons

Can be edited in Edit -> Preferences -> Filter Buttons. One can add/remove, enable/disable, re-order, or clean up labels and comments

Enabled by default.
|Button Label|	Comment|
|---|---|
|BACnet Only|	Only BACnet packets
|Instance ID|	Enter Instance ID
|IP Addr|	Enter IP Address (Send & Receive)
|IP Dst|	Enter Receiving IP Address
|IP Src|	Enter Sending IP Address
|RP|	Read Property
|RPM|	Read Property Multiple
|WP|	Write Property
|WPM|	Write Property Multiple

Disabled by default.
|Button Label|	Comment|
|---|---|
|N/A|	N/A

### 7 IO Graphs

|Color|	Graph Name|
|---|---|
|Black|	All packets
|Light Green|	Read Property
|Green|	Read Property Multiple
|Light Purple|	Write Property
|Purple|	Write Property Multiple

### 8 Troubleshooting Scenarios

Instance ID
IP Addr
IP Dst
IP Src
Enter the values for a specific device you are investigating
* Enter Device Instance ID in range from 0 to 4,194,302 (4,194,303 is Unconfigured)
* Enter IP address in IPV4 format nnn.nnn.nnn.nnn

**RP - ReadProperty**
These packets are polling for a single BACnet value.

**RPM - ReadPropertyMultiple*
These packets are polling for multiple BACnet objects.

**WP - WriteProperty**
These packets are writing of single BACnet object.

**WPM - WritePropertyMultiple**
These packets are writing of multiple BACnet objects.
