# BACnet COV

## Profile for Wireshark Network Protocol Analyzer

**Revision 19.11** - Initial Release

Prepared By: David Purser
Contributors:

November 2019

### 1	Description and Objective

This document summarizes the files and configuration of this Wireshark profile for use in analyzing general BACnet COV (Change of Value).

It is expected that installers know how to capture BACnet IP and/or MSTP communication and use this document to learn how to use this profile to assist in analysis.

### 2	Files Included

Folder / Profile Name: **BACnet COV**

**cfilters** – capture filter. Edited by Capture -> Capture Filters….
**colorfilters** – packet colorization. Edited by View -> Coloring Rules…
**dfilter_buttons** – display filter buttons. Edited by + beside Expression… toolbar
**io_graphs** – IO graph filters. Edited by Statistics -> IO Graphs
**preferences** – Wireshark preferences. Edited by Edit -> Preferences

Install profile folder in **%AppData%\Wireshark\profiles**

### 3	Files Excluded

These files can be excluded as they are not pre-configured and are regenerated by Wireshark.

**decode_as_entries** – dissector assignments. Edited by Analyze -> Decode As…
**recent** – recent GUI related settings. Read at program start and written at program exit.


### 4	Preferences

Preferences changed from default GUI profile:
* Packet List & Packet Details in side-by-side view
* Packet Bytes window disabled

### 5	Coloring Rules

|Color|	Name|
|---|---|
|Dark Pink|	Subscribe COV
|Light Blue|	Confirmed COV Notification
|Blue|	Unconfirmed COV Notification
|Dark Blue|	Unconfirmed COV Notification Multiple

### 6	Display Filter Buttons

Can be edited in Edit -> Preferences -> Filter Buttons. One can add/remove, enable/disable, re-order, or clean up labels and comments

Enabled by default.
|Button Label|	Comment|
|---|---|
|BACnet Only|	Only BACnet packets
|Instance ID|	Enter Instance ID
|IP Addr|	Enter IP Address (Send & Receive)
|IP Dst|	Enter Receiving IP Address
|IP Src|	Enter Sending IP Address
|Subscribe|	Subscribe COV
|ConfirmedCOV|	Confirmed COV Notifications
|UnconfirmedCOV|	Unconfirmed COV Notifications
|UnconfirmedCOVMultiple|	Unconfirmed COV Multiple


Disabled by default.
|Button Label|	Comment|
|---|---|
|N/A|	N/A


### 7	IO Graphs

|Color|	Graph Name|
|---|---|
|Black|	All packets
|Dark Pink|	Subscribe COV 
|Light Blue|	Confirmed COV Notifications
|Blue|	Unconfirmed COV Notifications
|Dark Blue|	Unconfirmed COV Multiple Notifications

### 8	Troubleshooting Scenarios

Instance ID
IP Addr
IP Dst
IP Src
Enter the values for a specific device you are investigating
* Enter Device Instance ID in range from 0 to 4,194,302 (4,194,303 is Unconfigured)
* Enter IP address in IPV4 format nnn.nnn.nnn.nnn

**SubscribeCOV**

These packets are subscriptions requests and replies that include current value.

**ConfirmedCOV**

These packets are sent when value changes by COV increment and require subscribing controller to reply with confirmation. This communication should be monitored to make sure updates are not send more than 4 times per minute. Confirmed COV require a reply, so are used for important communications, but also require more bandwidth because of reply and retransmits if no reply is received.

**UnconfirmedCOV**

These packets are sent when value changes by COV increment and require no reply. This communication should be monitored to make sure updates are not send more than 4 times per minute.

**UnconfirmedCOV Multiple**

These packets are sent when values change by COV increment and are sent at once. It does not require reply. This communication should be monitored to make sure updates are not send more than 4 times per minute.
