# BACnet General
## Profile for Wireshark Network Protocol Analyzer

**Revision 19.11** - Initial Release

Prepared By: David Purser
Contributors: 

November 2019

### 1	Description and Objective

This document summarizes the files and configuration of this Wireshark profile for use in analyzing general BACnet Communications.

It is expected that installers know how to capture BACnet IP and/or MSTP communication and use this document to learn how to use this profile to assist in analysis.

### 2	Files Included

Folder / Profile Name: **BACnet General**

**cfilters** – capture filter. Edited by Capture -> Capture Filters….
**colorfilters** – packet colorization. Edited by View -> Coloring Rules…
**dfilter_buttons** – display filter buttons. Edited by + beside Expression… toolbar
**io_graphs** – IO graph filters. Edited by Statistics -> IO Graphs
**preferences** – Wireshark preferences. Edited by Edit -> Preferences

Install profile folder in **%AppData%\Wireshark\profiles**

### 3	Files Excluded

These files can be excluded as they are not preconfigured and are regenerated by Wireshark.

**decode_as_entries** – dissector assignments. Edited by Analyze -> Decode As…
**recent** – recent GUI related settings. Read at program start and written at program exit.

### 4	Preferences

Preferences changed from default GUI profile:
* Packet List & Packet Details in side-by-side view
* Packet Bytes window disabled

### 5	Coloring Rules

|Color|	Name|
|---|---|
|Burgundy|	Alarms and Events
|Blue|	COV
|Green|	Read
|Purple|	Write
|Yellow|	I & Who
|Orange|	Time Synchronization
|Red|	Error

### 6	Display Filter Buttons

Can be edited in Edit -> Preferences -> Filter Buttons. One can add/remove, enable/disable, re-order, or clean up labels and comments

Enabled by default.
|Button Label|	Comment|
|---|---|
|BACnet Only|	Only BACnet packets
|Instance ID|	Enter Instance ID
|IP Addr|	Enter IP Address (Send & Receive)
|IP Dst|	Enter Receiving IP Address
|IP Src|	Enter Sending IP Address
|Broadcasts|	Broadcast Packets from Global, IP and MSTP
|I & Who|	I-Am I-Have Who-Is Who-Has Packets
|Hop Count|	Low Hop Count
|Time Sync|	Time Synchronization packets
|Errors|	Error packets

Disabled by default.
|Button Label|	Comment|
|---|---|
|N/A|	N/A

### 7	IO Graphs

|Color|	Graph Name|
|---|---|
|Black|	All packets
|Dark Blue|	All BACnet 
|Burgundy|	Alarms and Events
|Light Blue|	COV
|Green|	Read
|Purple|	Write
|Yellow|	I & Who
|Orange|	Time Synchronization
|Red|	Errors

### 8	Troubleshooting Scenarios

**BACnet Only**
Use this button to filter down to BACnet packets only. 
One can export only the BACnet packets with this process:
1.	Click BACnet Only button
2.	Go to File -> Export Specified Packets
3.	Enter Filename
4.	Make sure Radio Buttons for **All packets** and **Displayed** are selected and you can see number of packets where those intersect.
5.	Click Save button


Instance ID
IP Addr
IP Dst
IP Src
Enter the values for a specific device you are investigating
•	Enter Device Instance ID in range from 0 to 4,194,302 (4,194,303 is Unconfigured)
•	Enter IP address in IPV4 format nnn.nnn.nnn.nnn

**Broadcasts**
These packets are broadcast to all devices. One can delete the part of the filter you do not require to filter the Global, IP, and MSTP down further.

**I & Who**
These packets are for I-Am, I-Have, Who-Is, Who-Has for device discovery from Frontend, Application like WorkPlaceTech, or another BACnet device looking to subscribe or reference BACnet device or object.

**Hop Count**
This looks for Hop Count less than 10 that identifies packets that have passed through multiple routers, more than by design, indicating there is a routing loop issue.

**Time Sync**
Identifying time sync packets that may be sending out incorrect time or flooding the system

**Errors**
Identifying error packets to be investigated.
